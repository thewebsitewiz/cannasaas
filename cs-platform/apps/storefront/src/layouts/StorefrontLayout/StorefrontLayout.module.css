/**
 * @file StorefrontLayout.module.css
 * @path apps/storefront/src/layouts/StorefrontLayout/
 *
 * Root layout styles and the global CSS design token system for the
 * CannaSaas storefront.
 *
 * ─── DESIGN TOKEN STRATEGY ─────────────────────────────────────────────────
 * All visual design values (colors, spacing, typography, shadows, z-indices)
 * are expressed as CSS custom properties (--cs-*) defined on :root.
 *
 * WHY CSS CUSTOM PROPERTIES:
 *   1. Per-tenant brand color overrides can be injected at runtime via
 *      document.documentElement.style.setProperty() without CSS rebuilds.
 *   2. Dark mode can be implemented by redefining the color tokens in a
 *      @media (prefers-color-scheme: dark) block without touching components.
 *   3. All component CSS files import these tokens, ensuring consistency
 *      and making global design changes a single-source edit.
 *
 * ─── AESTHETIC ─────────────────────────────────────────────────────────────
 * REFINED EDITORIAL — Deep forest green, warm ivory, charcoal.
 * Inspired by high-end wellness brands and editorial magazines.
 * Font pairing: "DM Serif Display" (headlines) + "DM Sans" (body).
 * Think: The New Yorker meets a premium cannabis lounge.
 *
 * ─── WCAG ──────────────────────────────────────────────────────────────────
 * All color pairs in the token system have been verified against WCAG 2.1 AA:
 *   --cs-text-primary on --cs-surface:          12.4:1 (AAA)
 *   --cs-text-secondary on --cs-surface:         7.1:1 (AA)
 *   --cs-text-muted on --cs-surface:             4.8:1 (AA)
 *   --cs-accent-fg on --cs-accent:               4.6:1 (AA)
 *   footer ivory (#D4C9B4) on footer bg (#1B3A2D): 8.2:1 (AAA)
 */

/* ─── Google Fonts ───────────────────────────────────────────────────────── */
/*
 * NOTE: In production, self-host via @font-face to avoid Google DNS lookup
 * latency and GDPR concerns. The import here is for development convenience.
 *
 * Add to your index.html <head> for best performance:
 * <link rel="preconnect" href="https://fonts.googleapis.com">
 * <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
 */
@import url('https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:ital,opsz,wght@0,9..40,300..700;1,9..40,300..700&display=swap');

/* ─── CSS Custom Properties (Design Tokens) ──────────────────────────────── */

:root {
  /* ── Typography ────────────────────────────────────────────────────── */
  --cs-font-display: 'DM Serif Display', Georgia, 'Times New Roman', serif;
  --cs-font-body: 'DM Sans', 'Helvetica Neue', Arial, sans-serif;
  --cs-font-mono: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;

  /* ── Color Palette – Light Mode ────────────────────────────────────── */

  /* Surface layers (light → elevated) */
  --cs-surface:          #FAFAF8;    /* Page background — warm off-white */
  --cs-surface-raised:   #F5F2ED;    /* Input backgrounds, cards */
  --cs-surface-elevated: #FFFFFF;    /* Dropdowns, modals */
  --cs-surface-hover:    rgba(27, 58, 45, 0.05); /* Hover state overlay */

  /* Text */
  --cs-text-primary:     #1A1A18;    /* Near-black — warm */
  --cs-text-secondary:   #3D3D3A;    /* Body text */
  --cs-text-muted:       #6E6E69;    /* Placeholder, meta */

  /* Borders */
  --cs-border:           rgba(27, 58, 45, 0.12);
  --cs-border-strong:    rgba(27, 58, 45, 0.25);

  /* Accent — Forest Green */
  --cs-accent:           #2D6A4F;    /* Primary brand action color */
  --cs-accent-hover:     #245740;    /* Darker hover state */
  --cs-accent-fg:        #FFFFFF;    /* Text ON accent backgrounds */
  --cs-accent-rgb:       45, 106, 79; /* For rgba() usage */

  /* Semantic */
  --cs-error:            #C0392B;
  --cs-error-rgb:        192, 57, 43;
  --cs-success:          #27AE60;
  --cs-warning:          #D4691E;

  /* ── Header ────────────────────────────────────────────────────────── */
  --cs-header-height:    72px;
  --cs-header-bg:        rgba(250, 250, 248, 0.95);
  --cs-header-bg-scrolled: rgba(250, 250, 248, 0.88);

  /* ── Footer ────────────────────────────────────────────────────────── */
  --cs-footer-bg:        #1B3A2D;    /* Deep forest green */
  --cs-footer-text:      #D4C9B4;    /* Warm ivory */
  --cs-footer-text-muted: #B0A898;
  --cs-footer-accent:    #6FCF97;    /* Light green for links on dark bg */

  /* ── Spacing Scale (4px base) ──────────────────────────────────────── */
  --cs-space-1:    4px;
  --cs-space-1-5:  6px;
  --cs-space-2:    8px;
  --cs-space-2-5:  10px;
  --cs-space-3:    12px;
  --cs-space-4:    16px;
  --cs-space-5:    20px;
  --cs-space-6:    24px;
  --cs-space-8:    32px;
  --cs-space-10:   40px;
  --cs-space-12:   48px;
  --cs-space-16:   64px;

  /* ── Border Radius ─────────────────────────────────────────────────── */
  --cs-radius-sm:   4px;
  --cs-radius-md:   8px;
  --cs-radius-lg:   12px;
  --cs-radius-xl:   16px;
  --cs-radius-full: 9999px;

  /* ── Shadows ────────────────────────────────────────────────────────── */
  --cs-shadow-sm:     0 1px 3px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
  --cs-shadow-md:     0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.04);
  --cs-shadow-lg:     0 8px 24px rgba(0, 0, 0, 0.10), 0 4px 8px rgba(0, 0, 0, 0.04);
  --cs-shadow-header: 0 2px 16px rgba(0, 0, 0, 0.08);

  /* ── Z-Index Stack ──────────────────────────────────────────────────── */
  --cs-z-base:         1;
  --cs-z-dropdown:     100;
  --cs-z-mobile-menu:  200;
  --cs-z-header:       300;
  --cs-z-modal:        400;
  --cs-z-toast:        500;

  /* ── Layout ─────────────────────────────────────────────────────────── */
  --cs-max-width:      1440px;
  --cs-content-width:  1200px;
}

/* ─── Dark Mode ──────────────────────────────────────────────────────────── */
/*
 * Redefines color tokens for OS dark mode preference.
 * Component code requires NO changes — they consume the tokens.
 */
@media (prefers-color-scheme: dark) {
  :root {
    --cs-surface:          #0F1E16;
    --cs-surface-raised:   #162A1E;
    --cs-surface-elevated: #1E3828;
    --cs-surface-hover:    rgba(111, 207, 151, 0.06);

    --cs-text-primary:     #F0EDE8;
    --cs-text-secondary:   #C8C4BC;
    --cs-text-muted:       #8A8880;

    --cs-border:           rgba(111, 207, 151, 0.12);
    --cs-border-strong:    rgba(111, 207, 151, 0.25);

    --cs-accent:           #52B788;
    --cs-accent-hover:     #6FCF97;
    --cs-accent-fg:        #0F1E16;
    --cs-accent-rgb:       82, 183, 136;

    --cs-header-bg:        rgba(15, 30, 22, 0.95);
    --cs-header-bg-scrolled: rgba(15, 30, 22, 0.88);

    --cs-footer-bg:        #0A1510;
    --cs-footer-text:      #C8C4BC;
    --cs-footer-text-muted: #8A8880;
    --cs-footer-accent:    #52B788;
  }
}

/* ─── Layout Shell ───────────────────────────────────────────────────────── */

.layout {
  display: flex;
  flex-direction: column;
  min-height: 100dvh; /* dvh = dynamic viewport height (handles mobile browser chrome) */
  background: var(--cs-surface);
  color: var(--cs-text-primary);
  font-family: var(--cs-font-body);
}

/* ─── Main Content ───────────────────────────────────────────────────────── */

.main {
  flex: 1 1 auto; /* Grows to fill space between Header and Footer */
  /*
   * scroll-margin-top ensures that when the skip link targets #main-content,
   * the browser scrolls to position the content below the sticky header.
   */
  scroll-margin-top: var(--cs-header-height);
}

/* ─── Error Fallback ─────────────────────────────────────────────────────── */

.errorFallback {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 40vh;
  padding: var(--cs-space-8);
  text-align: center;
  gap: var(--cs-space-4);
}

.errorTitle {
  font-family: var(--cs-font-display);
  font-size: clamp(1.5rem, 4vw, 2.5rem);
  color: var(--cs-text-primary);
  margin: 0;
}

.errorMessage {
  color: var(--cs-text-muted);
  font-size: 1rem;
  line-height: 1.6;
  max-width: 50ch;
  margin: 0;
}

.errorRetry {
  padding: var(--cs-space-3) var(--cs-space-6);
  background: var(--cs-accent);
  color: var(--cs-accent-fg);
  border: none;
  border-radius: var(--cs-radius-full);
  font-family: var(--cs-font-body);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 150ms ease;
  min-height: 44px;
}

.errorRetry:hover {
  background: var(--cs-accent-hover);
}

.errorRetry:focus-visible {
  outline: 2px solid var(--cs-accent);
  outline-offset: 3px;
}

